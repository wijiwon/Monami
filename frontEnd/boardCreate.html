<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- axios ë¡œ ì˜ˆì „ì— ì“°ë˜ form íƒœê·¸ ëŒ€ì‹  ì „ì†¡â­â­â­ -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

</head>

<style>





.content_background {
    position: fixed;

    background-color: rgba(0, 0, 0, 0.3);

    left: 0;
    right: 0;
    bottom: 0;
    top: 0;

    display: flex;
    justify-content: center;
    align-items: center;
}


.content_wrapper { 
    width: 80vh;
    height: 87vh;

    border-radius: 1em;
    padding: 0.8em 2em;

    background-color: whitesmoke;
}



.post_img_title_wrap {
    background-color: thistle;

    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
}

.content_closeBtn { 
    margin-left: auto;
    cursor: pointer;
}


.post_img_upload_Container { 
    background-color: palegoldenrod;
    width: 100%;
    height: 30%;
    border-radius: 0.5em;

    
}

.main_contents_wrap {
    background-color: magenta;
    height: 85%;

    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-around;

}

.post_1st_wrap {
    /* flex-shrink: 0; */

    height: 100%;
    width: 40%;
    background-color: lawngreen;
    display: flex;
    justify-content: center;
    align-items: flex-start;

}


#post_img_pv{ 
    width: 95%;
    height: 95%;
}


.post_2nd_wrap {
    background-color: lightgray;
    height: 100%;
    width: 55%;
    
    display: flex;
    flex-direction: column;
    justify-content: space-evenly;
}


.postTile_wrap  {
    background-color: tan;
    /* display: flex; */
    /* flex-direction: column; */
}


.text_input{
    width: 80%;
    height: 3em;
}


.postText_wrap { 
    background-color: thistle;
}

.postTags_wrap { 
    background-color: tomato;
}

.postWriteBtn_wrap { 
    background-color: burlywood;
}

</style>




<body>




<!--  ë’· ë°°ê²½ | âœ… ë’¤ì— gif ë„£ê±°ë‚˜ | ì•„ë‹ˆë©´, ì—¬ê¸°ì²˜ëŸ¼, ì´ë¯¸ì§€ ë„£ê³  -> ê·¸ ë‹¤ìŒ íŒì—… ë„ì›Œë„ ë  ë“¯ -->
    <div class="content_background">

    <!-- í•˜ì–€ìƒ‰ ê¸€ì“°ëŠ” ê³³ -->
    <div class="content_wrapper">

        <!-- 1. ë§¨ìœ„ ì œëª© ì˜ì—­ : final touches | ì·¨ì†Œ ë²„íŠ¼ -->
            <div class="post_img_title_wrap">
                
                <!-- 1) ì œëª© -->
                <h2 class="post_img_title">Final touches</h2>

                <!-- 2) ì·¨ì†Œë²„íŠ¼ -->
                <div class="content_closeBtn" id="closeBtn">
                    â
                </div>
            </div>




        <!-- 2. ë©”ì¸ ì½˜í…ì¸  : ì œëª©, ì‚¬ì§„ ì˜¬ë¦¬ê¸°, ë‚´ìš© ë“± -->
        <div class="main_contents_wrap">

            <!-- 2.1 ì™¼ìª½ ì˜ì—­ | ë¯¸ë¦¬ë³´ê¸° ì‚¬ì§„ ì˜¬ë¼ê° -->
                <div class="post_1st_wrap">
                    <!-- 1) ì‚¬ì§„ ì˜¬ë¼ê°€ëŠ” ì˜ì—­ -->
                        <div class="post_img_upload_Container">
                                
                            <p> Thumnail Preview </p>
                            
                            <!-- b) ë¯¸ë¦¬ë³´ê¸° ë‚˜ì˜¤ëŠ” ì˜ì—­ | ì‚¬ì§„ ì˜¬ë¼ê°€ëŠ” ì˜ì—­ì— ê³ ì • ë˜ì–´ì•¼ í•¨ -->
                            <img id="post_img_pv" onerror="style.display='none'" alt="">
                            <!-- [í•´ì„] 
                                onerror="style.display='none'
                                1) imgì— ì´ë¯¸ì§€ê°€ ì—†ì„ë•Œ ë‚˜ì˜¤ëŠ” ì—‘ë°•ì„ ì•ˆë³´ì´ê²Œ í•´ì¤Œ 
                                2) ì—†ì–´ë„ ë˜ê¸´ í•˜ëŠ” ê²ƒ ê°™ì€ë°, ìš°ì„ , í•´ë†“ìŒ 
                            -->

                            <!-- a) íŒŒì¼ ì˜¬ë¦¬ëŠ” ë¶€ë¶„ -->
                            <input type="file" id="post_img"> <br>
                        
                        </div>
                </div>

            <!-- 2.2 ì˜¤ë¥¸ìª½ ì˜ì—­ | ì œëª©, ì„¤ëª…, íƒœê·¸, -->
        
                <div class="post_2nd_wrap"> 
    
                    <!-- 1) ì œëª© -->
                    <div class="postTile_wrap">
                        <label for=""> Title  </label> <br>
                        <input type="text" id="title" placeholder="Add Titles" class="text_input"> <br>
                        <div class="suggested_wrap" > <span class="suggested_title" > Suggested : </span> <span class="suggested_title_examples"> íŒ¡íŒ¡ì—ì„œ ê°€ì§€ë³¶ìŒë°¥ ê¸°ë‹¤ë¦¬ê¸° </span> </div>
                    </div>

                    <!-- 2) ë³¸ë¬¸ -->
                    <div class="postText_wrap">
                        <label for=""> Description (minimum 200) </label> <br> 
                        <input type="text" id="content" class="text_input" placeholder="Add description"> <br>
                        <div class="suggested_wrap" > <span class="suggested_desc" > Suggested : </span> <span class="suggested_desc_examples"> íŒ¡íŒ¡ ê°€ì§€ ë³¶ìŒë°¥, ìœ íŠœë¸Œ, ì£¼ë°©ì¥, ì–´ë¬µ ë§›ì§‘, ë°‘ë°˜ì°¬ ë§›ì§‘, êµìˆ˜ë‹˜, ì–‘ì¡°ì ˆ ì‹¤íŒ¨, ë§›ì¡°ì ˆë§Œ ì„±ê³µ, ëŒ€ê¸° ì‹œê°„ ì¡°ì ˆ ì‹¤íŒ¨, í¬í•œí•˜ê²Œ ë˜ ê°€ê²Œ ë¨ </span> </div>

                    </div>
    
                    <!-- 3) íƒœê·¸ -->
                    <div class="postTags_wrap">
                        <label for=""> Tags (maximum 20) </label> <br>
                        <input type="text" id="tags" class="text_input" placeholder="Add tags">
                        <div class="suggested_wrap" > <span class="suggested_tags" > Suggested : </span> <span class="suggested_tag_examples">friend, alien, animal, animation, monster</span> </div>

                    </div>
    
                    <!-- 4) ê¸€ì“°ê¸° ë²„íŠ¼ -->
                    <div class="postWriteBtn_wrap">
                        <button id="writeBtn"> ê¸€ì“°ê¸° </button>
                    </div>
    
                </div>            

        </div>




        </div>
    </div>


        <!-- ğŸ‘‡ğŸ‘‡ ì—¬ê¸°ë¶€í„°ëŠ” ì˜ˆì „ ì½”ë“œ | ì´ì œ keep ğŸ‘‡ğŸ‘‡ -->

            <!-- ì œëª© -->
            <!-- <label for="">ì œëª©</label>
            <input type="text" id="title"> <br> -->

            <!-- ë³¸ë¬¸ -->
            <!-- <label for="">ë³¸ë¬¸ | minimum 200</label> 
            <input type="text" id="content"> <br> -->

            <!-- íƒœê·¸ -->
            <!-- <label for=""> tags | maximum 20 , ì¶”ì²œ íƒœê·¸ </label>
            <input type="text" id="tags"> -->

            <!-- <br> -->

        <!-- ì‚¬ì§„ -->
        <!-- <input type="file" id="post_img"> <br> -->

        <!-- ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸° âœ… -->
        <!-- <img id="post_img_pv" onerror="style.display='none'" alt=""> -->
            <!-- [í•´ì„] 
                    onerror="style.display='none'
                        1) imgì— ì´ë¯¸ì§€ê°€ ì—†ì„ë•Œ ë‚˜ì˜¤ëŠ” ì—‘ë°•ì„ ì•ˆë³´ì´ê²Œ í•´ì¤Œ 
                        2) ì—†ì–´ë„ ë˜ê¸´ í•˜ëŠ” ê²ƒ ê°™ì€ë°, ìš°ì„ , í•´ë†“ìŒ 
                -->
        <!-- <br> -->

        <!-- ê¸€ì“°ê¸° ë²„íŠ¼ -->
        <!-- <button id="writeBtn"> ê¸€ì“°ê¸° </button> -->


</body>


<script>

// ì „ì—­ë³€ìˆ˜ 
    let reader = new FileReader();
    // const token = localStorage.getItem('access_token'); // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ í† í° ê°’ì„ ê°€ì ¸ì˜¨ë‹¤ê³  ê°€ì •




// ğŸ”¹ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥ 
    // 1. input íƒœê·¸ê°€ ë³€ê²½ë˜ë©´, profile í•¨ìˆ˜ ì‹¤í–‰í•´ì„œ, 1) ë³€í™˜ 2) ë³´ì—¬ì£¼ê¸° 
    post_img.addEventListener("click" , () => {
        post_img.onchange = (e) => {
            const filename = e.target.files[0];
            profile(filename);
        }
    })

    // 2. profile í•¨ìˆ˜ ì •ì˜
    const profile = (value) => {
        // reader.readAsDataURL(value) ë©”ì†Œë“œ ëë‚˜ë©´, ì‹¤í–‰ë¨
        reader.onload = () => {

            // readAsDataURL ë³€í™˜ê°’ì„ res ì— í• ë‹¹
            res = reader.result;
                // [í•´ì„]
                    // reader.result == reader.readAsDataURL(value)ì˜ ê²°ê³¼ê°’

            // ë¯¸ë¦¬ë³´ê¸° img íƒœê·¸ì— res ë„£ê¸°
            post_img_pv.setAttribute("src" , res);
                // [í•´ì„]
                    // ë¯¸ë¦¬ë³´ê¸° img íƒœê·¸ë¥¼ pv ë¡œ ê°€ì ¸ì˜¤ê³ , src ì†ì„±ì—, res í• ë‹¹
            
            // pv ë³´ì´ê²Œ í•˜ê¸° 
            post_img_pv.style.display = 'block'
                // [ì• ë§¤í•œ ê²ƒ]
                    // pv ê°€ ì´ì „ì—ëŠ” êº¼ì¡Œì—ˆë‚˜â“â“â“â“â“
        }
        // íŒŒì¼ ë§¤ê°œë³€ìˆ˜ë¥¼ ì½ì–´ì„œ -> base 64 ë¡œ ë³€í™˜
        reader.readAsDataURL(value);
            // [í•´ì„]
                // ì™„ë£Œë˜ë©´, reader.onload ê°€ ì‹¤í–‰ë¨
    }


    
// ğŸ”¹ ê¸€ì“°ê¸° ë²„íŠ¼ í´ë¦­ì‹œ axios post ìš”ì²­ 
    writeBtn.onclick = async () => {
        
        try {
            // form ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
            const form = new FormData();
    
            // form ê°ì²´ ì•ˆì— ë°ì´í„° append í•˜ê¸°
            form.append("title" , title.value);
            form.append("content" , content.value);
            form.append("tags" , tags.value);
            form.append("post_img" , post_img.files[0]);
    
            console.log("[@boardCreate.html] ê²Œì‹œê¸€ ì œëª©, ë³¸ë¬¸, ì‚¬ì§„ ë“¤ì–´ì˜¤ê³  ìˆëŠ”ì§€ : " , title.value, content.value, tags.value, post_img.files[0])
    
    
            // axios ì „ì†¡ | await ë¶™ì—¬ì•¼â“â“ 
            const e = await axios.post("http://127.0.0.1:4000/board/create" , form, { 
                
                // type ì„¤ì • : ì„¤ì •ì— ë”°ë¼, ì„œë²„ê°€ ê¸°ëŒ€í•˜ëŠ” ê°’ì´ ë‹¬ë¼ì§
                "Content-Type" : "multipart/form-data",
                withCredentials: true,  // â­â­â­â­â­â­â­â­â­â­â­â­â­
    
                    // [í•´ì„] í—¤ë”ì˜ ë‚´ìš©ìœ¼ë¡œ, ì¸ì½”ë”©ëœ, í¼ ë°ì´í„°ë¡œ ì „ì†¡í•œë‹¤ê³  ì„¤ì •
                    // [ì£¼ì˜] : ë§Œì•½, í…ìŠ¤íŠ¸ ë°ì´í„°ë©´, json/application ìœ¼ë¡œ, ì´ê²ƒê³¼ ë‹¤ë¥´ê²Œ ì„¤ì •í•´ì•¼ í•¨
                
                // isLogin ê´€ë ¨ ì„¤ì •
                // "Authorization": `Bearer ${token}`
                    // â­â­â­â­â­ ì´ê±¸ ì¶”ê°€ í•´ì•¼ > ë¯¸ë“¤ì›¨ì–´ islogin ì—ì„œ   const authHeader = req.headers.authorization ì´ ê°’ì´ ì•ˆ ë¹„ì–´ìˆê²Œ ë¨ â­â­â­â­â­
            })
            // }).then( (e) => {
                
                // redirect ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° â­â­â­ 
                    const redirectURL = e.data.redirectURL;
                    
                    console.log("redirectURL ì´ê²Œ ì–´ë–»ê²Œ ë„˜ì–´ì˜¤ì§€? @boardCreate" , redirectURL)
                    window.location.href = redirectURL;
                        // [ì´ë ‡ê²Œ í•˜ëŠ” ì´ìœ ] â­â­â­â­â­â­â­â­
                            // axios ë¥¼ í†µí•´ì„œ post ìš”ì²­ì„ ë³´ë‚´ê³ , redirect ë¥¼ í•˜ë©´, 
                            // axios í†µì‹ ì— ì˜í•´, ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ redirect ë¥¼ ì•ˆí•˜ëŠ” ê²½ìš°ê°€ ìƒê¹€. 
                            // ë”°ë¼ì„œ, ì„œë²„ì—ì„œ redirect í•  url ì„ json í˜•ì‹ìœ¼ë¡œ ë³´ë‚´ê³ , ê·¸ê±¸ ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬ í•´ì•¼ í•¨. 
                            // ë‹¤ë§Œ, ì´ê²Œ ê¼­ í•„ìš”í•œê°€? ë‹¤ë¥¸ ë°©ë²•ì€ ì—†ë‚˜? 
                console.log("axios post ì˜ ì „ë‹¬í–ˆê³ , redirect ìˆ˜ë™ìœ¼ë¡œ ì˜ ì²˜ë¦¬í•¨ ğŸ™†â€â™‚ï¸")
            
        } catch (error) {
            console.log(error)
        }
    }


// ğŸ”¹ ì·¨ì†Œë²„íŠ¼ ëˆ„ë¥´ë©´ -> ê²Œì‹œê¸€ ëª©ë¡ìœ¼ë¡œ ì´ë™í•˜ê¸° 
    closeBtn.onclick = () => {
        try {
            window.location.href = 'http://127.0.0.1:4000/board/list/view'
        } catch (error) {
            console.log(error)
        }
    }




</script>


</html>